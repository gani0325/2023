"""
ğŸ’› ì½”ë“œíŠ¸ë¦¬ ì±„ì ê¸°
ì½”ë“œíŠ¸ë¦¬ì— ì½”ë“œ ì œì¶œì´ ì˜¬ë¼ì˜¤ë©´ ì´ë¥¼ ì–´ë–»ê²Œ ì²˜ë¦¬í•˜ëŠ”ì§€ì— ëŒ€í•œ ì •ë³´ëŠ” ì•„ë˜ì™€ ê°™ìŠµë‹ˆë‹¤.

(1) ì½”ë“œíŠ¸ë¦¬ ì±„ì ê¸° ì¤€ë¹„
Nê°œì˜ ì±„ì ê¸°ê°€ ì¤€ë¹„ë˜ì–´ ìˆê³ , ì´ˆê¸° ë¬¸ì œ urlì— í•´ë‹¹í•˜ëŠ” u0 â€‹ê°€ ì£¼ì–´ì§‘ë‹ˆë‹¤.
ë¬¸ì œì—ì„œì˜ urlì€ ë„ë©”ì¸/ë¬¸ì œID í˜•íƒœë¡œ ì£¼ì–´ì§‘ë‹ˆë‹¤.
ë„ë©”ì¸ì€ ì•ŒíŒŒë²³ ì†Œë¬¸ìì™€ '.'ìœ¼ë¡œë§Œ ì´ë£¨ì–´ì ¸ ìˆê³ , ë¬¸ì œ IDëŠ” 1ì´ìƒ 10ì–µ ì´í•˜ì˜ ì •ìˆ˜ê°’ìœ¼ë¡œ ì´ë£¨ì–´ì ¸ ìˆìŠµë‹ˆë‹¤.
Nê°œì˜ ì±„ì ê¸°ì—ëŠ” 1ë²ˆë¶€í„° Në²ˆê¹Œì§€ ë²ˆí˜¸ê°€ ë¶™ì–´ìˆê³ , 0ì´ˆì— ì±„ì  ìš°ì„ ìˆœìœ„ê°€ 1ì´ë©´ì„œ urlì´ u0â€‹ ì¸ ì´ˆê¸° ë¬¸ì œì— ëŒ€í•œ ì±„ì  ìš”ì²­ì´ ë“¤ì–´ì˜¤ê²Œ ë©ë‹ˆë‹¤. 
ì±„ì  taskëŠ” ì±„ì  ëŒ€ê¸° íì— ë“¤ì–´ê°€ê²Œ ë©ë‹ˆë‹¤.

(2) ì±„ì  ìš”ì²­
tì´ˆì— ì±„ì  ìš°ì„ ìˆœìœ„ê°€ pì´ë©´ì„œ urlì´ uì¸ ë¬¸ì œì— ëŒ€í•œ ì±„ì  ìš”ì²­ì´ ë“¤ì–´ì˜¤ê²Œ ë©ë‹ˆë‹¤. 
ì±„ì  taskëŠ” ì±„ì  ëŒ€ê¸° íì— ë“¤ì–´ê°€ê²Œ ë©ë‹ˆë‹¤. 
ë‹¨, ì±„ì  ëŒ€ê¸° íì— ìˆëŠ” task ì¤‘ ì •í™•íˆ uì™€ ì¼ì¹˜í•˜ëŠ” urlì´ ë‹¨ í•˜ë‚˜ë¼ë„ ì¡´ì¬í•œë‹¤ë©´ íì— ì¶”ê°€í•˜ì§€ ì•Šê³  ë„˜ì–´ê°‘ë‹ˆë‹¤.

(3) ì±„ì  ì‹œë„
tì´ˆì— ì±„ì  ëŒ€ê¸° íì—ì„œ ì¦‰ì‹œ ì±„ì ì´ ê°€ëŠ¥í•œ ê²½ìš° ì¤‘ ìš°ì„ ìˆœìœ„ê°€ ê°€ì¥ ë†’ì€ ì±„ì  taskë¥¼ ê³¨ë¼ ì±„ì ì„ ì§„í–‰í•©ë‹ˆë‹¤.
ìš°ì„  ì–´ë– í•œ taskê°€ ì±„ì ì´ ë  ìˆ˜ ì—†ëŠ” ì¡°ê±´ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.
    í•´ë‹¹ taskì˜ ë„ë©”ì¸ì´ í˜„ì¬ ì±„ì ì„ ì§„í–‰ì¤‘ì¸ ë„ë©”ì¸ ì¤‘ í•˜ë‚˜ë¼ë©´ ë¶ˆê°€ëŠ¥í•©ë‹ˆë‹¤.
    í•´ë‹¹ taskì˜ ë„ë©”ì¸ê³¼ ì •í™•íˆ ì¼ì¹˜í•˜ëŠ” ë„ë©”ì¸ì— ëŒ€í•´ ê°€ì¥ ìµœê·¼ì— ì§„í–‰ëœ ì±„ì  ì‹œì‘ ì‹œê°„ì´ start, ì¢…ë£Œ ì‹œê°„ì´ start+gap
        í˜„ì¬ ì‹œê°„ tê°€ start+3Ã—gap ë³´ë‹¤ ì‘ë‹¤ë©´, ë¶€ì ì ˆí•œ ì±„ì ì´ë¼ ì˜ì‹¬ë˜ê¸°ì— ì±„ì ì´ ë¶ˆê°€í•©ë‹ˆë‹¤.

ì¦‰ì‹œ ì±„ì ì´ ê°€ëŠ¥í•œ ê²½ìš° ì¤‘ ìš°ì„ ìˆœìœ„ê°€ ê°€ì¥ ë†’ì€ ì±„ì  taskëŠ” ì•„ë˜ ì¡°ê±´ì— ë”°ë¼ ê³¨ë¼ì§‘ë‹ˆë‹¤.
    ì±„ì  ìš°ì„ ìˆœìœ„ pì˜ ë²ˆí˜¸ê°€ì‘ì„ìˆ˜ë¡ ìš°ì„ ìˆœìœ„ê°€ ë†’ìŠµë‹ˆë‹¤.
    ë§Œì•½ ì±„ì  ìš°ì„ ìˆœìœ„ê°€ ë™ì¼í•˜ë‹¤ë©´ ì±„ì  taskê°€ ì±„ì  ëŒ€ê¸° íì— ë“¤ì–´ì˜¨ ì‹œê°„ì´ ë” ë¹ ë¥¼ìˆ˜ë¡ ìš°ì„ ìˆœìœ„ê°€ ë†’ìŠµë‹ˆë‹¤.
tì´ˆì— ì±„ì ì´ ê°€ëŠ¥í•œ taskê°€ ë‹¨ í•˜ë‚˜ë¼ë„ ìˆì—ˆë‹¤ë©´, 
ì‰¬ê³  ìˆëŠ” ì±„ì ê¸° ì¤‘ ê°€ì¥ ë²ˆí˜¸ê°€ ì‘ì€ ì±„ì ê¸°ê°€ ìš°ì„ ìˆœìœ„ê°€ ê°€ì¥ ë†’ì€ ì±„ì  taskì— ëŒ€í•œ ì±„ì ì„ ì‹œì‘í•©ë‹ˆë‹¤. ë§Œì•½ ì‰¬ê³  ìˆëŠ” ì±„ì ê¸°ê°€ ì—†ë‹¤ë©´ ìš”ì²­ì„ ë¬´ì‹œí•˜ê³  ë„˜ì–´ê°‘ë‹ˆë‹¤.

(4) ì±„ì  ì¢…ë£Œ
tì´ˆì— J id ë²ˆ ì±„ì ê¸°ê°€ ì§„í–‰í•˜ë˜ ì±„ì ì´ ì¢…ë£Œë©ë‹ˆë‹¤. J id  ì±„ì ê¸°ëŠ” ë‹¤ì‹œ ì‰¬ëŠ” ìƒíƒœê°€ ë©ë‹ˆë‹¤.
ë§Œì•½ J id ë²ˆ ì±„ì ê¸°ê°€ ì§„í–‰í•˜ë˜ ì±„ì ì´ ì—†ì—ˆë‹¤ë©´ ì´ ëª…ë ¹ì€ ë¬´ì‹œë©ë‹ˆë‹¤.

(5) ì±„ì  ëŒ€ê¸° í ì¡°íšŒ
ì‹œê°„ tì— ì±„ì  ëŒ€ê¸° íì— ìˆëŠ” ì±„ì  taskì˜ ìˆ˜ë¥¼ ì¶œë ¥í•©ë‹ˆë‹¤.
Që²ˆì— ê±¸ì³ ëª…ë ¹ì„ ìˆœì„œëŒ€ë¡œ ì§„í–‰í•˜ë©° ì•Œë§ì€ ë‹µì„ ì¶œë ¥í•˜ëŠ” í”„ë¡œê·¸ë¨ì„ ì‘ì„±í•´ë³´ì„¸ìš”.

ğŸ§¡ ì…ë ¥ í˜•ì‹
ì²« ë²ˆì§¸ ì¤„ì— ëª…ë ¹ì˜ ìˆ˜ Qê°€ ì£¼ì–´ì§‘ë‹ˆë‹¤.
ë‘ ë²ˆì§¸ ì¤„ë¶€í„°ëŠ” Qê°œì˜ ì¤„ì— ê±¸ì³ ëª…ë ¹ì˜ ì •ë³´ê°€ ì£¼ì–´ì§‘ë‹ˆë‹¤. ê° ëª…ë ¹ì— ë”°ë¥¸ í˜•íƒœëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.
    ì½”ë“œíŠ¸ë¦¬ ì±„ì ê¸° ì¤€ë¹„
        100 N u0 í˜•íƒœë¡œ ê³µë°±ì„ ì‚¬ì´ì— ë‘ê³  ì£¼ì–´ì§‘ë‹ˆë‹¤. ì´ëŠ” Nê°œì˜ ì±„ì ê¸°ê°€ ìˆìœ¼ë©° ì´ˆê¸° ë¬¸ì œ urlì´ u0 ì„ì„ ëœ»í•©ë‹ˆë‹¤.
        ì´ ëª…ë ¹ì€ í•­ìƒ ì²« ë²ˆì§¸ ëª…ë ¹ìœ¼ë¡œë§Œ ì£¼ì–´ì§€ë©°, í•­ìƒ ì£¼ì–´ì§‘ë‹ˆë‹¤.
    ì±„ì  ìš”ì²­
        200 t p u í˜•íƒœë¡œ ê³µë°±ì„ ì‚¬ì´ì— ë‘ê³  ì£¼ì–´ì§‘ë‹ˆë‹¤. 
        ì´ëŠ” tì´ˆì— ì±„ì  ìš°ì„ ìˆœìœ„ê°€ pì´ë©° urlì´ uì¸ ë¬¸ì œì— ëŒ€í•œ ì±„ì  ìš”ì²­ì´ ë“¤ì–´ì™”ìŒì„ ì˜ë¯¸í•©ë‹ˆë‹¤.
    ì±„ì  ì‹œë„
        300 t í˜•íƒœë¡œ ê³µë°±ì„ ì‚¬ì´ì— ë‘ê³  ì£¼ì–´ì§‘ë‹ˆë‹¤. 
        ì´ëŠ” tì´ˆì— ì±„ì  ëŒ€ê¸° íì—ì„œ ì¦‰ì‹œ ì±„ì ì´ ê°€ëŠ¥í•œ ê²½ìš° ì¤‘ ìš°ì„ ìˆœìœ„ê°€ ê°€ì¥ ë†’ì€ ì±„ì  taskë¥¼ ê³¨ë¼ ì±„ì ì„ ì§„í–‰í•˜ê²Œ ë¨ì„ ëœ»í•©ë‹ˆë‹¤.
    ì±„ì  ì¢…ë£Œ
        400 t J_id í˜•íƒœë¡œ ê³µë°±ì„ ì‚¬ì´ì— ë‘ê³  ì£¼ì–´ì§‘ë‹ˆë‹¤. ì´ëŠ” tì´ˆì— J idâ€‹ ë²ˆ ì±„ì ê¸°ê°€ ì§„í–‰í•˜ë˜ ì±„ì ì´ ì¢…ë£Œë¨ì„ ëœ»í•©ë‹ˆë‹¤.
    ì±„ì  ëŒ€ê¸° í ì¡°íšŒ
        500 t í˜•íƒœë¡œ ê³µë°±ì„ ì‚¬ì´ì— ë‘ê³  ì£¼ì–´ì§‘ë‹ˆë‹¤. ì´ ê²½ìš° ì‹œê°„ tì— ì±„ì  ëŒ€ê¸° íì— ìˆëŠ” ì±„ì  taskì˜ ìˆ˜ë¥¼ ì¶œë ¥í•´ì•¼í•©ë‹ˆë‹¤.

1 â‰¤ Q â‰¤ 50,000
1 â‰¤ N â‰¤ 50,000
1 â‰¤ ë„ë©”ì¸ì˜ ê¸¸ì´ â‰¤ 19
1 â‰¤ ì£¼ì–´ì§€ëŠ” ì„œë¡œ ë‹¤ë¥¸ ë„ë©”ì¸ì˜ ìˆ˜ â‰¤ 300
1 â‰¤ ë¬¸ì œ ID â‰¤ 1,000,000,000
1 â‰¤ p â‰¤ N
1 â‰¤ J id  â‰¤ N
1 â‰¤ t â‰¤ 1,000,000
ì…ë ¥ìœ¼ë¡œ ì£¼ì–´ì§€ëŠ” t ê°’ì€ ëª¨ë‘ ë‹¤ë¥´ë©°, ì˜¤ë¦„ì°¨ìˆœìœ¼ë¡œ ì •ë ¬ë˜ì–´ ì£¼ì–´ì§ì„ ê°€ì •í•´ë„ ì¢‹ìŠµë‹ˆë‹¤.

ğŸ’š ì¶œë ¥ í˜•ì‹
500ëª…ë ¹ì–´ì— ëŒ€í•´ ì±„ì  ëŒ€ê¸° íì— ìˆëŠ” taskì˜ ìˆ˜ë¥¼ í•œ ì¤„ì— í•˜ë‚˜ì”© ì¶œë ¥í•©ë‹ˆë‹¤.

ğŸ§ ì…ì¶œë ¥ ì˜ˆì œ
ì˜ˆì œ1
â¡ï¸ ì…ë ¥:
19
100 3 codetree.ai/16
300 1
400 4 1
200 5 1 codetree.ai/17
200 6 1 codetree.ai/17
500 7
300 8
500 9
300 11
400 12 1
500 13
200 14 3 codetree.ai/18
200 15 2 codetree.ai/20
200 16 2 tree.ai/1
500 17
300 18
500 19
200 20 1 codetree.ai/20
500 21

â¡ï¸ ì¶œë ¥:
1 
1
0
3
2
3
"""
from sortedcontainers import SortedSet, SortedDict
import heapq
import sys


class PriorityQueue:
    def __init__(self):          # ë¹ˆ Priority Queue í•˜ë‚˜ë¥¼ ìƒì„±í•©ë‹ˆë‹¤.
        self.items = []

    def push(self, item):        # ìš°ì„ ìˆœìœ„ íì— ë°ì´í„°ë¥¼ ì¶”ê°€í•©ë‹ˆë‹¤.
        heapq.heappush(self.items, item)

    def empty(self):             # ìš°ì„ ìˆœìœ„ íê°€ ë¹„ì–´ìˆìœ¼ë©´ Trueë¥¼ ë°˜í™˜í•©ë‹ˆë‹¤.
        return not self.items

    def size(self):              # ìš°ì„ ìˆœìœ„ íì— ìˆëŠ” ë°ì´í„° ìˆ˜ë¥¼ ë°˜í™˜í•©ë‹ˆë‹¤.
        return len(self.items)

    def pop(self):               # ìš°ì„ ìˆœìœ„ íì— ìˆëŠ” ë°ì´í„° ì¤‘ ìµœì†Ÿê°’ì— í•´ë‹¹í•˜ëŠ” ë°ì´í„°ë¥¼ ë°˜í™˜í•˜ê³  ì œê±°í•©ë‹ˆë‹¤.
        if self.empty():
            raise Exception("PriorityQueue is empty")

        return heapq.heappop(self.items)

    # ìš°ì„ ìˆœìœ„ íì— ìˆëŠ” ë°ì´í„° ì¤‘ ìµœì†Ÿê°’ì— í•´ë‹¹í•˜ëŠ” ë°ì´í„°ë¥¼ ì œê±°í•˜ì§€ ì•Šê³  ë°˜í™˜í•©ë‹ˆë‹¤.
    def top(self):
        if self.empty():
            raise Exception("PriorityQueue is empty")

        return self.items[0]


MAX_D = 300
MAX_N = 50000
INF = sys.maxsize

# í•´ë‹¹ ë„ë©”ì¸ì—ì„œ í•´ë‹¹ ë¬¸ì œIDê°€ ë ˆë””íì— ìˆëŠ”ì§€ ê´€ë¦¬í•´ì¤ë‹ˆë‹¤.
is_in_readyq = [SortedSet() for _ in range(MAX_D + 1)]

# í˜„ì¬ ì‰¬ê³  ìˆëŠ” ì±„ì ê¸°ë“¤ì„ ê´€ë¦¬í•´ì¤ë‹ˆë‹¤.
rest_judger = PriorityQueue()

# ê° ì±„ì ê¸°ë“¤ì´ ì±„ì í•  ë•Œ, ë„ë©”ì¸ì˜ ì¸ë±ìŠ¤ë¥¼ ì €ì¥í•©ë‹ˆë‹¤.
judging_domain = [0 for _ in range(MAX_N + 1)]

# ê° ë„ë©”ì¸ë³„ start, gap, end(ì±„ì ì´ ê°€ëŠ¥í•œ ìµœì†Œ ì‹œê°„)ì„ ê´€ë¦¬í•©ë‹ˆë‹¤.
s = [0 for _ in range(MAX_D + 1)]
g = [0 for _ in range(MAX_D + 1)]
e = [0 for _ in range(MAX_D + 1)]

# ë„ë©”ì¸ì„ ê´€ë¦¬í•˜ê¸° ìœ„í•´ cntë¥¼ ì´ìš©í•©ë‹ˆë‹¤.
# ë„ë©”ì¸ ë¬¸ìì—´ì„ intë¡œ ë³€í™˜í•´ì£¼ëŠ” mapì„ ê´€ë¦¬í•©ë‹ˆë‹¤.
domainToIdx = SortedDict()
global cnt
cnt = 0

# í˜„ì¬ ì±„ì  ëŒ€ê¸° íì— ìˆëŠ” taskì˜ ê°œìˆ˜ë¥¼ ê´€ë¦¬í•©ë‹ˆë‹¤.
global ans
ans = 0

# ê° ë„ë©”ì¸ë³„ë¡œ priority queueë¥¼ ë§Œë“¤ì–´
# ìš°ì„ ìˆœìœ„ê°€ ê°€ì¥ ë†’ì€ urlì„ ë½‘ì•„ì¤ë‹ˆë‹¤.
url_pq = [PriorityQueue() for _ in range(MAX_D + 1)]


# ì±„ì ê¸°ë¥¼ ì¤€ë¹„í•©ë‹ˆë‹¤.
def Init(query):
    global n
    (empty, n, url) = query
    n = int(n)

    global cnt

    for i in range(1, n + 1):
        rest_judger.push(i)

    # urlì—ì„œ ë„ë©”ì¸ ë¶€ë¶„ê³¼ ìˆ«ì ë¶€ë¶„ì„ ë‚˜ëˆ„ì–´ì¤ë‹ˆë‹¤.
    idx = 0
    for i in range(len(url)):
        if url[i] == '/':
            idx = i

    domain = url[:idx]
    num = int(url[idx + 1:])

    # ë§Œì•½ ë„ë©”ì¸ì´ ì²˜ìŒ ë‚˜ì˜¨ ë„ë©”ì¸ì´ë¼ë©´ domainToIdxì— ê°±ì‹ í•©ë‹ˆë‹¤.
    if not domain in domainToIdx:
        cnt += 1
        domainToIdx[domain] = cnt
    domain_idx = domainToIdx[domain]

    # ë„ë©”ì¸ ë²ˆí˜¸ì— ë§ëŠ” ë ˆë””íì— ìˆ«ì ë¶€ë¶„ì„ ë„£ì–´ì¤ë‹ˆë‹¤.
    is_in_readyq[domain_idx].add(num)

    # ìƒˆë¡œ ë“¤ì–´ì˜¨ urlì„ ë„ë©”ì¸ì— ë§ì¶° url_pqì— ë„£ì–´ì¤ë‹ˆë‹¤.
    # id, tme, num
    newUrl = (1, 0, num)
    url_pq[domain_idx].push(newUrl)

    # ì±„ì  ëŒ€ê¸° íì— ê°’ì´ ì¶”ê°€ëìœ¼ë¯€ë¡œ ê°œìˆ˜ë¥¼ 1 ì¶”ê°€í•©ë‹ˆë‹¤.
    global ans
    ans += 1


# ìƒˆë¡œìš´ urlì„ ì…ë ¥ë°›ì•„ ë ˆë””íì— ì¶”ê°€í•´ì¤ë‹ˆë‹¤.
def NewUrl(query):
    (empty, tme, id, url) = query
    tme = int(tme)
    id = int(id)

    global cnt

    # urlì—ì„œ ë„ë©”ì¸ ë¶€ë¶„ê³¼ ìˆ«ì ë¶€ë¶„ì„ ë‚˜ëˆ„ì–´ì¤ë‹ˆë‹¤.
    idx = 0
    for i in range(len(url)):
        if url[i] == '/':
            idx = i

    domain = url[:idx]
    num = int(url[idx + 1:])

    # ë§Œì•½ ë„ë©”ì¸ì´ ì²˜ìŒ ë‚˜ì˜¨ ë„ë©”ì¸ì´ë¼ë©´ domainToIdxì— ê°±ì‹ í•©ë‹ˆë‹¤.
    if domain not in domainToIdx:
        cnt += 1
        domainToIdx[domain] = cnt

    domain_idx = domainToIdx[domain]

    # ë§Œì•½ ìˆ«ì ë¶€ë¶„ì´ ì´ë¯¸ ë ˆë””íì— ìˆìœ¼ë©´ ì¤‘ë³µë˜ë¯€ë¡œ ë„˜ì–´ê°‘ë‹ˆë‹¤.
    if num in is_in_readyq[domain_idx]:
        return
    # ë„ë©”ì¸ ë²ˆí˜¸ì— ë§ëŠ” ë ˆë””íì— ìˆ«ì ë¶€ë¶„ì„ ë„£ì–´ì¤ë‹ˆë‹¤.
    is_in_readyq[domain_idx].add(num)

    # ìƒˆë¡œ ë“¤ì–´ì˜¨ urlì„ ë„ë©”ì¸ì— ë§ì¶° url_pqì— ë„£ì–´ì¤ë‹ˆë‹¤.
    # id, tme, num
    newUrl = (id, tme, num)
    url_pq[domain_idx].push(newUrl)

    # ì±„ì  ëŒ€ê¸° íì— ê°’ì´ ì¶”ê°€ëìœ¼ë¯€ë¡œ ê°œìˆ˜ë¥¼ 1 ì¶”ê°€í•©ë‹ˆë‹¤.
    global ans
    ans += 1


# ë‹¤ìŒ ë„ë©”ì¸ì„ ì°¾ì•„ assigní•©ë‹ˆë‹¤.
def Assign(query):
    (empty, tme) = query
    tme = int(tme)

    # ì‰¬ê³  ìˆëŠ” ì±„ì ê¸°ê°€ ì—†ë‹¤ë©´ ë„˜ì–´ê°‘ë‹ˆë‹¤.
    if rest_judger.empty():
        return

    # ê°€ì¥ ìš°ì„ ìˆœìœ„ê°€ ë†’ì€ urlì„ ì°¾ìŠµë‹ˆë‹¤.
    min_domain = 0
    minUrl = (INF, 0, 0)

    global cnt

    for i in range(1, cnt + 1):
        # ë§Œì•½ í˜„ì¬ ì±„ì ì¤‘ì´ê±°ë‚˜, í˜„ì¬ ì‹œê°„ì— ì´ìš©í•  ìˆ˜ ì—†ë‹¤ë©´ ë„˜ì–´ê°‘ë‹ˆë‹¤.
        if e[i] > tme:
            continue

        # ë§Œì•½ ië²ˆ ë„ë©”ì¸ì— í•´ë‹¹í•˜ëŠ” urlì´ ì¡´ì¬í•œë‹¤ë©´
        # í•´ë‹¹ ë„ë©”ì¸ì—ì„œ ê°€ì¥ ìš°ì„ ìˆœìœ„ê°€ ë†’ì€ urlì„ ë½‘ê³  ê°±ì‹ í•´ì¤ë‹ˆë‹¤.
        if not url_pq[i].empty():
            curUrl = url_pq[i].top()

            if minUrl > curUrl:
                minUrl = curUrl
                min_domain = i

    # ë§Œì•½ ê°€ì¥ ìš°ì„ ìˆœìœ„ê°€ ë†’ì€ urlì´ ì¡´ì¬í•˜ë©´
    # í•´ë‹¹ ë„ë©”ì¸ê³¼ ì‰¬ê³  ìˆëŠ” ê°€ì¥ ë‚®ì€ ë²ˆí˜¸ì˜ ì±„ì ê¸°ë¥¼ ì—°ê²°í•´ì¤ë‹ˆë‹¤.
    if min_domain:
        judger_idx = rest_judger.top()
        rest_judger.pop()

        # í•´ë‹¹ ë„ë©”ì¸ì˜ ê°€ì¥ ìš°ì„ ìˆœìœ„ê°€ ë†’ì€ urlì„ ì§€ì›ë‹ˆë‹¤.
        url_pq[min_domain].pop()

        # ë„ë©”ì¸ì˜ start, endë¥¼ ê°±ì‹ í•´ì¤ë‹ˆë‹¤.
        s[min_domain] = tme
        e[min_domain] = INF

        # judger_idxë²ˆ ì±„ì ê¸°ê°€ ì±„ì í•˜ê³  ìˆëŠ” ë„ë©”ì¸ ë²ˆí˜¸ë¥¼ ê°±ì‹ í•´ì¤ë‹ˆë‹¤.
        judging_domain[judger_idx] = min_domain

        # ë ˆë””íì—ì„œ í•´ë‹¹ urlì˜ ìˆ«ìë¥¼ ì§€ì›Œì¤ë‹ˆë‹¤.
        is_in_readyq[min_domain].remove(minUrl[2])

        # ì±„ì  ëŒ€ê¸° íì— ê°’ì´ ì§€ì›Œì¡Œìœ¼ë¯€ë¡œ ê°œìˆ˜ë¥¼ 1 ê°ì†Œí•©ë‹ˆë‹¤.
        global ans
        ans -= 1


# ì±„ì  í•˜ë‚˜ë¥¼ ë§ˆë¬´ë¦¬í•©ë‹ˆë‹¤.
def Finish(query):
    (empty, tme, id) = query
    tme = int(tme)
    id = int(id)

    # ë§Œì•½ idë²ˆ ì±„ì ê¸°ê°€ ì±„ì  ì¤‘ì´ ì•„ë‹ ê²½ìš° ìŠ¤í‚µí•©ë‹ˆë‹¤.
    if judging_domain[id] == 0:
        return

    # idë²ˆ ì±„ì ê¸°ë¥¼ ë§ˆë¬´ë¦¬í•©ë‹ˆë‹¤.
    rest_judger.push(id)
    domain_idx = judging_domain[id]
    judging_domain[id] = 0

    # í•´ë‹¹ ë„ë©”ì¸ì˜ gap, end ê°’ì„ ê°±ì‹ í•´ì¤ë‹ˆë‹¤.
    g[domain_idx] = tme - s[domain_idx]
    e[domain_idx] = s[domain_idx] + 3 * g[domain_idx]


# í˜„ì¬ ì±„ì  ëŒ€ê¸° íì— ìˆëŠ” urlì˜ ê°œìˆ˜ë¥¼ ì¶œë ¥í•´ì¤ë‹ˆë‹¤.
def Check(query):
    (empty, tme) = query
    tme = int(tme)

    global ans
    print(ans)


q = int(input())

for _ in range(q):
    query = input().split()

    if int(query[0]) == 100:
        # ì±„ì ê¸°ë¥¼ ì¤€ë¹„í•©ë‹ˆë‹¤.
        Init(query)
    if int(query[0]) == 200:
        # ìƒˆë¡œìš´ urlì„ ì…ë ¥ë°›ì•„ ë ˆë””íì— ì¶”ê°€í•´ì¤ë‹ˆë‹¤.
        NewUrl(query)
    if int(query[0]) == 300:
        # ë‹¤ìŒ ë„ë©”ì¸ì„ ì°¾ì•„ assigní•©ë‹ˆë‹¤.
        Assign(query)
    if int(query[0]) == 400:
        # ì±„ì  í•˜ë‚˜ë¥¼ ë§ˆë¬´ë¦¬í•©ë‹ˆë‹¤.
        Finish(query)
    if int(query[0]) == 500:
        # í˜„ì¬ ì±„ì  ëŒ€ê¸° íì— ìˆëŠ” urlì˜ ê°œìˆ˜ë¥¼ ì¶œë ¥í•´ì¤ë‹ˆë‹¤.
        Check(query)
