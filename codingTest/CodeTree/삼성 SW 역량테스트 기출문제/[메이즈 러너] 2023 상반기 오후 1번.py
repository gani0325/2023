"""
ğŸ’› ë©”ì´ì¦ˆ ëŸ¬ë„ˆ
Mëª…ì˜ ì°¸ê°€ìê°€ ë¯¸ë¡œ íƒˆì¶œí•˜ê¸° ê²Œì„ì— ì°¸ê°€í•˜ì˜€ìŠµë‹ˆë‹¤.
ë¯¸ë¡œì˜ êµ¬ì„±ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.

    1. ë¯¸ë¡œëŠ” NÃ—N í¬ê¸°ì˜ ê²©ìì…ë‹ˆë‹¤. 
        ê° ìœ„ì¹˜ëŠ” (r,c)ì˜ í˜•íƒœë¡œ í‘œí˜„ë˜ë©°, ì•„ë˜ë¡œ ê°ˆìˆ˜ë¡ rì´ ì¦ê°€, ì˜¤ë¥¸ìª½ìœ¼ë¡œ ê°ˆìˆ˜ë¡ cê°€ ì¦ê°€í•©ë‹ˆë‹¤.
        ì¢Œìƒë‹¨ì€ (1,1)ì…ë‹ˆë‹¤.

    2. ë¯¸ë¡œì˜ ê° ì¹¸ì€ ë‹¤ìŒ 3ê°€ì§€ ì¤‘ í•˜ë‚˜ì˜ ìƒíƒœë¥¼ ê°–ìŠµë‹ˆë‹¤.
        ë¹ˆ ì¹¸
            ì°¸ê°€ìê°€ ì´ë™ ê°€ëŠ¥í•œ ì¹¸ì…ë‹ˆë‹¤.
        ë²½
            ì°¸ê°€ìê°€ ì´ë™í•  ìˆ˜ ì—†ëŠ” ì¹¸ì…ë‹ˆë‹¤.
            1ì´ìƒ 9ì´í•˜ì˜ ë‚´êµ¬ë„ë¥¼ ê°–ê³  ìˆìŠµë‹ˆë‹¤.
            íšŒì „í•  ë•Œ, ë‚´êµ¬ë„ê°€ 1ì”© ê¹ì…ë‹ˆë‹¤.
            ë‚´êµ¬ë„ê°€ 0ì´ ë˜ë©´, ë¹ˆ ì¹¸ìœ¼ë¡œ ë³€ê²½ë©ë‹ˆë‹¤.
        ì¶œêµ¬
            ì°¸ê°€ìê°€ í•´ë‹¹ ì¹¸ì— ë„ë‹¬í•˜ë©´, ì¦‰ì‹œ íƒˆì¶œí•©ë‹ˆë‹¤.

1ì´ˆë§ˆë‹¤ ëª¨ë“  ì°¸ê°€ìëŠ” í•œ ì¹¸ì”© ì›€ì§ì…ë‹ˆë‹¤. ì›€ì§ì´ëŠ” ì¡°ê±´ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.
    ë‘ ìœ„ì¹˜ (x1,y1), (x2,y2)ì˜ ìµœë‹¨ê±°ë¦¬ëŠ” âˆ£x1âˆ’x2âˆ£+âˆ£y1âˆ’y2âˆ£ë¡œ ì •ì˜ë©ë‹ˆë‹¤.
    ëª¨ë“  ì°¸ê°€ìëŠ” ë™ì‹œì— ì›€ì§ì…ë‹ˆë‹¤.
    ìƒí•˜ì¢Œìš°ë¡œ ì›€ì§ì¼ ìˆ˜ ìˆìœ¼ë©°, ë²½ì´ ì—†ëŠ” ê³³ìœ¼ë¡œ ì´ë™í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
    ì›€ì§ì¸ ì¹¸ì€ í˜„ì¬ ë¨¸ë¬¼ëŸ¬ ìˆë˜ ì¹¸ë³´ë‹¤ ì¶œêµ¬ê¹Œì§€ì˜ ìµœë‹¨ ê±°ë¦¬ê°€ ê°€ê¹Œì›Œì•¼ í•©ë‹ˆë‹¤.
    ì›€ì§ì¼ ìˆ˜ ìˆëŠ” ì¹¸ì´ 2ê°œ ì´ìƒì´ë¼ë©´, ìƒí•˜ë¡œ ì›€ì§ì´ëŠ” ê²ƒì„ ìš°ì„ ì‹œí•©ë‹ˆë‹¤.
    ì°¸ê°€ê°€ê°€ ì›€ì§ì¼ ìˆ˜ ì—†ëŠ” ìƒí™©ì´ë¼ë©´, ì›€ì§ì´ì§€ ì•ŠìŠµë‹ˆë‹¤.
    í•œ ì¹¸ì— 2ëª… ì´ìƒì˜ ëª¨í—˜ê°€ê°€ ìˆì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ëª¨ë“  ì°¸ê°€ìê°€ ì´ë™ì„ ëëƒˆìœ¼ë©´, ë‹¤ìŒ ì¡°ê±´ì— ì˜í•´ ë¯¸ë¡œê°€ íšŒì „í•©ë‹ˆë‹¤.
    í•œ ëª… ì´ìƒì˜ ì°¸ê°€ìì™€ ì¶œêµ¬ë¥¼ í¬í•¨í•œ ê°€ì¥ ì‘ì€ ì •ì‚¬ê°í˜•ì„ ì¡ìŠµë‹ˆë‹¤.
    ê°€ì¥ ì‘ì€ í¬ê¸°ë¥¼ ê°–ëŠ” ì •ì‚¬ê°í˜•ì´ 2ê°œ ì´ìƒì´ë¼ë©´, ì¢Œìƒë‹¨ r ì¢Œí‘œê°€ ì‘ì€ ê²ƒì´ ìš°ì„ ë˜ê³ , 
        ê·¸ë˜ë„ ê°™ìœ¼ë©´ c ì¢Œí‘œê°€ ì‘ì€ ê²ƒì´ ìš°ì„ ë©ë‹ˆë‹¤.
    ì„ íƒëœ ì •ì‚¬ê°í˜•ì€ ì‹œê³„ë°©í–¥ìœ¼ë¡œ 90ë„ íšŒì „í•˜ë©°, íšŒì „ëœ ë²½ì€ ë‚´êµ¬ë„ê°€ 1ì”© ê¹ì…ë‹ˆë‹¤.

Kì´ˆ ë™ì•ˆ ìœ„ì˜ ê³¼ì •ì„ ê³„ì† ë°˜ë³µë©ë‹ˆë‹¤. ë§Œì•½ Kì´ˆ ì „ì— ëª¨ë“  ì°¸ê°€ìê°€ íƒˆì¶œì— ì„±ê³µí•œë‹¤ë©´, ê²Œì„ì´ ëë‚©ë‹ˆë‹¤. 
ê²Œì„ì´ ëë‚¬ì„ ë•Œ, ëª¨ë“  ì°¸ê°€ìë“¤ì˜ ì´ë™ ê±°ë¦¬ í•©ê³¼ ì¶œêµ¬ ì¢Œí‘œë¥¼ ì¶œë ¥í•˜ëŠ” í”„ë¡œê·¸ë¨ì„ ì‘ì„±í•´ë³´ì„¸ìš”.

ğŸ§¡ ì…ë ¥ í˜•ì‹
ì²« ë²ˆì§¸ ì¤„ì— N, M, Kê°€ ê³µë°±ì„ ì‚¬ì´ì— ë‘ê³  ì£¼ì–´ì§‘ë‹ˆë‹¤.
ë‹¤ìŒ Nê°œì˜ ì¤„ì— ê±¸ì³ì„œ NÃ—N í¬ê¸°ì˜ ë¯¸ë¡œì— ëŒ€í•œ ì •ë³´ê°€ ì£¼ì–´ì§‘ë‹ˆë‹¤.
    0ì´ë¼ë©´, ë¹ˆ ì¹¸ì„ ì˜ë¯¸í•©ë‹ˆë‹¤.
    1ì´ìƒ 9ì´í•˜ì˜ ê°’ì„ ê°–ëŠ”ë‹¤ë©´, ë²½ì„ ì˜ë¯¸í•˜ë©°, í•´ë‹¹ ê°’ì€ ë‚´êµ¬ë„ë¥¼ ëœ»í•©ë‹ˆë‹¤.
ë‹¤ìŒ Mê°œì˜ ì¤„ì— ê±¸ì³ì„œ ì°¸ê°€ìì˜ ì¢Œí‘œê°€ ì£¼ì–´ì§‘ë‹ˆë‹¤. ëª¨ë“  ì°¸ê°€ìëŠ” ì´ˆê¸°ì— ë¹ˆ ì¹¸ì—ë§Œ ì¡´ì¬í•©ë‹ˆë‹¤.
ë‹¤ìŒ ì¤„ì— ì¶œêµ¬ì˜ ì¢Œí‘œê°€ ì£¼ì–´ì§‘ë‹ˆë‹¤. ì¶œêµ¬ëŠ” ë¹ˆ ì¹¸ì—ë§Œ ì£¼ì–´ì§‘ë‹ˆë‹¤.
    N: ë¯¸ë¡œì˜ í¬ê¸° (4â‰¤Nâ‰¤10)
    M: ì°¸ê°€ì ìˆ˜ (1â‰¤Mâ‰¤10)
    K: ê²Œì„ ì‹œê°„ (1â‰¤Kâ‰¤100)

ğŸ’š ì¶œë ¥ í˜•ì‹
ê²Œì„ ì‹œì‘ í›„ Kì´ˆê°€ ì§€ë‚¬ê±°ë‚˜, ëª¨ë“  ì°¸ê°€ìê°€ ë¯¸ë¡œë¥¼ íƒˆì¶œí–ˆì„ ë•Œ, 
ëª¨ë“  ì°¸ê°€ìë“¤ì˜ ì´ë™ ê±°ë¦¬ í•©ê³¼ ì¶œêµ¬ ì¢Œí‘œë¥¼ ì¶œë ¥í•©ë‹ˆë‹¤.

ğŸ§ ì…ì¶œë ¥ ì˜ˆì œ
ì˜ˆì œ1
â¡ï¸ ì…ë ¥:
5 3 8
0 0 0 0 1
9 2 2 0 0
0 1 0 1 0
0 0 0 1 0
0 0 0 0 0
1 3
3 1
3 5
3 3

â¡ï¸ ì¶œë ¥:
7
1 1
"""

# ë¯¸ë¡œ, ì°¸ê°€ì, ê²Œì„ì‹œê°„
n, m, k = tuple(map(int, input().split()))
maze = [[] * n for _ in range(n)]

# ë¯¸ë¡œ N X N
for i in range(n):
    maze[i] = list(map(int, input().split()))
    # [[0, 0, 0, 0, 1], [9, 2, 2, 0, 0], [0, 1, 0, 1, 0], [0, 0, 0, 1, 0], [0, 0, 0, 0, 0]]

# ì°¸ê°€ì ì¢Œí‘œ (-1, -2 ... ë¡œ ì§€ì •)
runner = []
for i in range(1, m+1):
    x, y = map(int, input().split())
    # ì°¸ê°€ì ì¢Œí‘œ list
    runner.append((x, y))       # [(1, 3), (3, 1), (3, 5)]
    # ì¸ë±ìŠ¤ê°€ 1ë¶€í„° ì‹œì‘í•´ì„œ -1 í•´ì¤€ë‹¤
    # maze[x - 1][y - 1] = -i

# ì¶œêµ¬ ì¢Œí‘œ
x, y = map(int, input().split())
runner.insert(0, (x, y))
# ì¸ë±ìŠ¤ê°€ 1ë¶€í„° ì‹œì‘í•´ì„œ -1 í•´ì¤€ë‹¤
maze[x - 1][y - 1] = 'X'

"""
[[0, 0, -1, 0, 1], 
[9, 2, 2, 0, 0], 
[-2, 1, 'X', 1, -3], 
[0, 0, 0, 1, 0], 
[0, 0, 0, 0, 0]]
"""

# ì°¸ê°€ì ì´ë™ =>  ì¶œêµ¬ + ì°¸ê°€ì [(3, 3), (1, 3), (3, 1), (3, 5)]
# ì¶œêµ¬ì™€ ê°€ê¹ê³ , ìƒí•˜ ìš°ì„ !
dx = [1, -1, 0, 0]
dy = [0, 0, -1, 1]

ans = 0
# íšŒì „í•´ì•¼ í•˜ëŠ” ìµœì†Œ ì •ì‚¬ê°í˜•ì„ ì°¾ì•„ ê¸°ë¡í•´ì¤ë‹ˆë‹¤.
sx, sy, square_size = 0, 0, 0
# íšŒì „ì˜ êµ¬í˜„ì„ í¸í•˜ê²Œ í•˜ê¸° ìœ„í•´ 2ì°¨ì› ë°°ì—´ì„ í•˜ë‚˜ ë” ì •ì˜í•´ì¤ë‹ˆë‹¤.
next_maze = [
    [0] * (n + 1)
    for _ in range(n + 1)
]


def move():
    global runner, ans

    # ì¶œêµ¬ì˜ ì¢Œí‘œ
    x, y = runner[0]
    x -= 1
    y -= 1
    for i in range(1, m+1):
        r, c = runner[i]
        r -= 1
        c -= 1

        for j in range(4):
            nx = r + dx[j]
            ny = c + dy[j]
            if (0 <= nx < n and 0 <= ny < n):
                # ë¹ˆì¹¸ì´ê±°ë‚˜ ì°¸ê°€ì ìë¦¬ë¼ë©´
                if (maze[nx][ny] == 0):
                    # ì²˜ìŒ ì¶œêµ¬ì™€ì˜ ê±°ë¦¬ë³´ë‹¤ ë©€ì–´ì§€ë©´
                    if (abs(r - x) < abs(r - nx)) or (abs(c - y) < abs(c - ny)):
                        continue
                    else:
                        # |x1 - x2] + |y1 - y2|
                        # ì´ë™í•œë‹¤
                        runner[i] = nx, ny
                        # maze[nx][ny] = i
                        maze[r][c] = 0
                else:
                    continue
    return runner, maze
